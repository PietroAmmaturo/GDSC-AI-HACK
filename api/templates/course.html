{% extends 'base.html' %}
{% block content %}
<h1>{{ course.title }}</h1>
<p>{{ course.description }}</p>
<div class="timeline">
  {% for chapter in course.chapters %} {% if forloop.counter|divisibleby:2 %}
  <div class="container right">
    {% else %}
    <div class="container left">
      {% endif %}
      <div class="content">
        <h2 onclick="this.nextElementSibling.style.display='block'">{{ chapter.title }}</h2>
		<div class ="chapter-details" style="display: none;" >
			<p>{{ chapter.description }}</p>
			<h3>Concepts</h3>
			<ul class="concept-list">
			  {% for concept in chapter.concepts %}
			  <li> <b>{{ concept.name }}</b>: {{ concept.description }}</li>
			  {% endfor %}
			</ul>
	
			<h3>Questions</h3>
			<ul class="question-list">
				{% for question in chapter.questions %}
				  <li>
					<form id="question{{ forloop.counter }}" method="post" action="">
					  {% csrf_token %}
					  <p><b>{{ question.question }}</b></p>
					  <ul class="option-list">
						{% for option in question.options %}
						  <li>
							<label>
							  <input type="radio" name="question{{ forloop.parentloop.counter }}" value="{{ option }}"  onclick="checkAnswer(this,'{{question.answer}}','{{question.explanation}}')">
							  {{ option }}
							</label>
						  </li>
						{% endfor %}
						<li style="display: none;">Explanation: <b>{{ question.explanation }}</b></li>
					  </ul>
					</form>
				  </li>
				{% endfor %}
			  </ul>
		</div>

      </div>
    </div>
    {% endfor %}
  </div>

  <style>
	  .concept-list,
  .question-list {
    list-style: none;
    padding-left: 0;
  }

  .option-list {
    margin-top: 10px;
	list-style: none;
	padding-left: 0;
  }

  .option-list li {
    margin-bottom: 5px;
  }

    * {
      box-sizing: border-box;
    }

    /* The actual timeline (the vertical ruler) */
    .timeline {
      position: relative;
      max-width: 1200px;
      margin: 0 auto;
      background-color: #474e5d;
    }

    /* The actual timeline (the vertical ruler) */
    .timeline::after {
      content: "";
      position: absolute;
      width: 6px;
      background-color: white;
      top: 0;
      bottom: 0;
      left: 50%;
      margin-left: -3px;
    }

    /* Container around content */
    .container {
      padding: 10px 40px;
      position: relative;
      background-color: inherit;
      width: 50%;
    }

    /* The circles on the timeline */
    .container::after {
      content: "";
      position: absolute;
      width: 25px;
      height: 25px;
      right: -17px;
      background-color: white;
      border: 4px solid #ff9f55;
      top: 15px;
      border-radius: 50%;
      z-index: 1;
    }

    /* Place the container to the left */
    .left {
      left: 0;
    }

    /* Place the container to the right */
    .right {
      left: 50%;
    }

    /* Add arrows to the left container (pointing right) */
    .left::before {
      content: " ";
      height: 0;
      position: absolute;
      top: 22px;
      width: 0;
      z-index: 1;
      right: 30px;
      border: medium solid white;
      border-width: 10px 0 10px 10px;
      border-color: transparent transparent transparent white;
    }

    /* Add arrows to the right container (pointing left) */
    .right::before {
      content: " ";
      height: 0;
      position: absolute;
      top: 22px;
      width: 0;
      z-index: 1;
      left: 30px;
      border: medium solid white;
      border-width: 10px 10px 10px 0;
      border-color: transparent white transparent transparent;
    }

    /* Fix the circle for containers on the right side */
    .right::after {
      left: -16px;
    }

    /* The actual content */
    .content {
      padding: 20px 30px;
      background-color: white;
      position: relative;
      border-radius: 6px;
    }
	.option-list p {
		border-radius: 5px;
		padding: 6px;
		background-color: #eee;
	}
	.option-list label {
		padding: 2px;
		border-radius: 5px;
	}
    /* Media queries - Responsive timeline on screens less than 600px wide */
    @media screen and (max-width: 600px) {
      /* Place the timelime to the left */
      .timeline::after {
        left: 31px;
      }

      /* Full-width containers */
      .container {
        width: 100%;
        padding-left: 70px;
        padding-right: 25px;
      }

      /* Make sure that all arrows are pointing leftwards */
      .container::before {
        left: 60px;
        border: medium solid white;
        border-width: 10px 10px 10px 0;
        border-color: transparent white transparent transparent;
      }

      /* Make sure all circles are at the same spot */
      .left::after,
      .right::after {
        left: 15px;
      }

      /* Make all right containers behave like the left ones */
      .right {
        left: 0%;
      }

	  .no-events{
		pointer-events: none;
	}
    }
  </style>

<script>
	function checkAnswer(selectedOption, correctAnswer, explanation) {
		console.log(correctAnswer, explanation)
	  var options = selectedOption.closest('.option-list').querySelectorAll('input[type="radio"]');
	  options.forEach(function(option) {
		var label = option.parentElement;
		label.style.backgroundColor = '';
		label.style.color = '';
	  });
	
	  if (selectedOption.value === correctAnswer) {
		selectedOption.parentElement.style.backgroundColor = 'lightgreen';
	  } else {
		selectedOption.parentElement.style.backgroundColor = 'lightcoral';
	  }
	
	  options.forEach(function(option) {
		if (option.value === correctAnswer) {
		  option.parentElement.style.backgroundColor = 'lightgreen';
		  option.parentElement.insertAdjacentHTML("afterend", '<p>' + explanation + '</p>');
		}
		option.removeAttribute("onclick");
		option.disabled=true;
	  });
	}
	</script>
</div>
{% endblock %}
